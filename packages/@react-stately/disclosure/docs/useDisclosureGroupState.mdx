{/* Copyright 2024 Adobe. All rights reserved.
This file is licensed to you under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License. You may obtain a copy
of the License at http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software distributed under
the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
OF ANY KIND, either express or implied. See the License for the specific language
governing permissions and limitations under the License. */}

import {Layout} from '@react-spectrum/docs';
export default Layout;

import docs from 'docs:@react-stately/disclosure';
import {ClassAPI, HeaderInfo, TypeContext, FunctionAPI, TypeLink, PageDescription} from '@react-spectrum/docs';
import packageData from '@react-stately/disclosure/package.json';
import ChevronRight from '@spectrum-icons/workflow/ChevronRight';

---
category: Navigation
keywords: [disclosure, collapse, expand, state]
preRelease: alpha
---

# useDisclosureGroupState

<PageDescription>{docs.exports.useDisclosureGroupState.description}</PageDescription>

<HeaderInfo
  packageData={packageData}
  componentNames={['useDisclosureGroupState']} />

## API

<FunctionAPI function={docs.exports.useDisclosureGroupState} links={docs.links} />

## Interface

{/* <ClassAPI links={docs.links} class={docs.links[docs.exports.useDisclosureGroupState.return.base.id]} /> */}

## Example

The following example shows how to create a `DisclosureGroup` component with the `useDisclosureGroupState` hook. We'll also create a `Disclosure` component that uses the `DisclosureGroupState` context for managing its state.

```tsx example export=true
import {useButton} from '@react-aria/button';
import {useDisclosure} from '@react-aria/disclosure';
import {useDisclosureGroupState, useDisclosureState} from '@react-stately/disclosure';
import {useId} from '@react-aria/utils';

const DisclosureGroupStateContext = React.createContext(null);

function DisclosureGroup(props) {
  let state = useDisclosureGroupState(props);

  return (
    <div className="group">
      <DisclosureGroupStateContext.Provider value={state}>
        {props.children}
      </DisclosureGroupStateContext.Provider>
    </div>
  );
}

function Disclosure(props) {
  let defaultId = useId();
  let id = props.id || defaultId;
  let groupState = React.useContext(DisclosureGroupStateContext);
  let isExpanded = groupState ? groupState.expandedKeys.has(id) : props.isExpanded;
  let state = useDisclosureState({
    ...props,
    isExpanded,
    onExpandedChange(isExpanded) {
      if (groupState) {
        groupState.toggleKey(id);
      }

      props.onExpandedChange?.(isExpanded);
    }
  });

  let panelRef = React.useRef<HTMLDivElement | null>(null);
  let triggerRef = React.useRef<HTMLButtonElement | null>(null);
  let isDisabled = props.isDisabled || groupState?.isDisabled || false;
  let {buttonProps: triggerProps, panelProps} = useDisclosure({
    ...props,
    isExpanded,
    isDisabled
  }, state, panelRef);
  let {buttonProps} = useButton(triggerProps, triggerRef);

  return (
    <div className="disclosure">
      <h3>
        <button className="trigger" ref={triggerRef} {...buttonProps}>
          <svg viewBox="0 0 24 24">
            <path d="m8.25 4.5 7.5 7.5-7.5 7.5" />
          </svg>
          {props.title}
        </button>
      </h3>
      <div className="panel" ref={panelRef} {...panelProps}>
        <p>
          {props.children}
        </p>
      </div>
    </div>
  );
};
```

<details>
  <summary style={{fontWeight: 'bold'}}><ChevronRight size="S" /> Show CSS</summary>

```css
.disclosure {
  .trigger {
    background: none;
    border: none;
    box-shadow: none;
    font-weight: bold;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 8px;

    svg {
      rotate: 0deg;
      transition: rotate 200ms;
      width: 12px;
      height: 12px;
      fill: none;
      stroke: currentColor;
      stroke-width: 3px;
    }

    &[aria-expanded="true"] svg {
      rotate: 90deg;
    }
  }
}

.panel {
  margin-left: 32px;
}
```

</details>

### Usage

The following examples show how to use the `DisclosureGroup` component created in the above example.

```tsx example
<DisclosureGroup>
  <Disclosure title="Personal Information">
    Personal information form here.
  </Disclosure>
  <Disclosure title="Billing Address">
    Billing address form here.
  </Disclosure>
</DisclosureGroup>
```

#### Default expansion

Which disclosure is expanded by default can be set with the `defaultExpandedKeys` prop.

```tsx example
<DisclosureGroup defaultExpandedKeys={['billing']}>
  <Disclosure id="personal" title="Personal Information">
    Personal information form here.
  </Disclosure>
  <Disclosure id="billing" title="Billing Address">
    Billing address form here.
  </Disclosure>
</DisclosureGroup>
```

#### Controlled expansion

Expansion can be controlled using the `expandedKeys` prop, paired with the `onExpandedChange` event. The `onExpandedChange` event is fired when one of the disclosures is expanded or collapsed.

```tsx example
function ControlledDisclosureGroup(props) {
  let [expandedKeys, setExpandedKeys] = React.useState(['personal']);

  return (
    <DisclosureGroup expandedKeys={expandedKeys} onExpandedChange={setExpandedKeys}>
      <Disclosure id="personal" title="Personal Information">
        Personal information form here.
      </Disclosure>
      <Disclosure id="billing" title="Billing Address">
        Billing address form here.
      </Disclosure>
    </DisclosureGroup>
  );
}
```

#### Multiple expanded

Multiple disclosures can be expanded at the same time by setting the `allowsMultipleExpanded` prop to `true`.

```tsx example
<DisclosureGroup allowsMultipleExpanded>
  <Disclosure title="Personal Information">
    Personal information form here.
  </Disclosure>
  <Disclosure title="Billing Address">
    Billing address form here.
  </Disclosure>
</DisclosureGroup>
```

#### Disabled

An entire disclosure group can be disabled with the `isDisabled` prop. This will disable all trigger buttons and prevent the panels from being opened or closed.

```tsx example
<DisclosureGroup isDisabled>
  <Disclosure title="Personal Information">
    Personal information form here.
  </Disclosure>
  <Disclosure title="Billing Address">
    Billing address form here.
  </Disclosure>
</DisclosureGroup>
```
